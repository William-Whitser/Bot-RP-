const { SlashCommandBuilder, EmbedBuilder } = require("discord.js");
const Licencia = require("../../schemas/licenciaSchema");

module.exports = {
  data: new SlashCommandBuilder()
    .setName("ver-licencia")
    .setDescription("Ver los datos de la licencia de un usuario")
    .addUserOption(option =>
      option.setName("usuario")
        .setDescription("Usuario a consultar")
        .setRequired(true)
    ),

  async execute(interaction) {
    const usuario = interaction.options.getUser("usuario");
    const licencia = await Licencia.findOne({ userId: usuario.id });

    if (!licencia) return interaction.reply("‚ùå Este usuario no tiene licencia.");

    const embed = new EmbedBuilder()
      .setTitle("ü™™ Licencia de Conducci√≥n")
      .addFields(
        { name: "Categor√≠a", value: licencia.categoria, inline: true },
        { name: "Puntos", value: `${licencia.puntos}`, inline: true },
        { name: "Expedici√≥n", value: licencia.fechaExpedicion.toLocaleDateString(), inline: true },
        { name: "Expiraci√≥n", value: licencia.fechaExpiracion.toLocaleDateString(), inline: true }
      )
      .setThumbnail(usuario.displayAvatarURL())
      .setColor("Blue");

    await interaction.reply({ embeds: [embed] });
  },
};
